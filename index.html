<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovusFace Custom UI</title>
    <style>
        body { background: #0b0f19; color: white; font-family: sans-serif; padding: 20px; text-align: center; }
        .container { max-width: 600px; margin: 0 auto; }
        
        .upload-box { 
            border: 2px dashed #00ffcc; padding: 20px; margin: 10px 0; border-radius: 10px;
            background: rgba(0, 255, 204, 0.1);
        }
        
        img { max-width: 100%; border-radius: 10px; margin-top: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
        
        button {
            background: #00ffcc; color: black; border: none; padding: 15px 30px; 
            font-size: 18px; font-weight: bold; cursor: pointer; border-radius: 30px;
            margin-top: 20px; width: 100%;
        }
        button:hover { background: #00ccaa; }
        
        .loader { display: none; color: #00ffcc; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="container">
        <h1>NOVUS//FACE <span style="color:#00ffcc">CUSTOM</span></h1>

        <div class="upload-box">
            <h3>1. Upload Your Face</h3>
            <input type="file" id="sourceFile" accept="image/*">
            <div id="srcPreview"></div>
        </div>

        <div class="upload-box">
            <h3>2. Upload Target Image</h3>
            <input type="file" id="targetFile" accept="image/*">
            <div id="tgtPreview"></div>
        </div>

        <div style="margin: 20px 0; text-align: left;">
            <label><input type="checkbox" id="chk4k"> Force 4K Quality</label>
        </div>

        <button onclick="runSwap()">âš¡ SWAP FACE NOW</button>
        
        <div class="loader" id="loader">Processing... Please wait 10-20 seconds...</div>

        <div id="resultArea" style="display:none; margin-top: 30px;">
            <h3>Result:</h3>
            <img id="finalImage" src="" />
            <br><br>
            <a id="dlBtn" href="#" download="NovusSwap.png" style="color: #00ffcc;">Download Image</a>
        </div>
    </div>

    <script>
        // REPLACE THIS WITH YOUR HUGGING FACE URL (Must end with no slash)
        const API_URL = "https://codewander-666-novusface-backend.hf.space";

        // Simple preview logic
        document.getElementById('sourceFile').onchange = function(e) {
            document.getElementById('srcPreview').innerHTML = `<img src="${URL.createObjectURL(e.target.files[0])}" height="100">`;
        };
        document.getElementById('targetFile').onchange = function(e) {
            document.getElementById('tgtPreview').innerHTML = `<img src="${URL.createObjectURL(e.target.files[0])}" height="100">`;
        };

        async function runSwap() {
            const src = document.getElementById('sourceFile').files[0];
            const tgt = document.getElementById('targetFile').files[0];
            const is4k = document.getElementById('chk4k').checked;
            
            if(!src || !tgt) { alert("Please upload both images!"); return; }

            document.getElementById('loader').style.display = 'block';
            document.getElementById('resultArea').style.display = 'none';

            // Prepare Data for API
            const formData = new FormData();
            formData.append('source', src);
            formData.append('target', tgt);
            formData.append('enable_4k', is4k);
            formData.append('enhance', 1.0); // Default enhancement

            try {
                // Call the Backend
                const response = await fetch(`${API_URL}/swap`, {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    // Convert Response Blob to Image
                    const blob = await response.blob();
                    const url = URL.createObjectURL(blob);
                    
                    document.getElementById('finalImage').src = url;
                    document.getElementById('dlBtn').href = url;
                    document.getElementById('resultArea').style.display = 'block';
                } else {
                    alert("Server Error: " + await response.text());
                }
            } catch (err) {
                alert("Connection Failed. Is the server running? " + err);
            } finally {
                document.getElementById('loader').style.display = 'none';
            }
        }
    </script>

</body>
</html>
